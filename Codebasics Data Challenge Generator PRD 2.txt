# Codebasics Data Challenge Generator
## Production Requirements Document v2.1

**Status:** Phase 1 Testing Complete â†’ Production Development  
**Date:** February 6, 2025  
**Contact:** vishal@codebasics.io

---

## ğŸ‰ Phase 1 Complete - Next Steps

Great work so far! Phase 1 testing has validated the core workflow. Now we're building the production application with these enhancements:

âœ… Research integration (6 free APIs)  
âœ… Groq LLM integration  
âœ… High-quality PDFs with logo  
âœ… Excel solution files  
âœ… Smart auto-configuration  
âœ… Simplified workflow

---

## 1. Updated Workflow

### Complete Flow
```
Initial Screen (5 inputs)
  â†’ Phase 1: Research & Problem
  â†’ Phase 2: Schema  
  â†’ Phase 3: Preview
  â†’ Phase 4: Full Dataset + QA
  â†’ Phase 5: Downloads
```

### Auto-Configuration by Difficulty

| Difficulty | Rows | Tables (Normalized) | Columns | Structure |
|------------|------|---------------------|---------|-----------|
| Easy | 5,000 | 5 (1 fact + 4 dims) | 15 | Auto |
| Medium | 10,000 | 8 (2 facts + 6 dims) | 22 | Auto |
| Difficult | 20,000 | 12 (2 facts + 10 dims) | 30 | Auto |

**If Denormalized**: Always 1 table, columns = 15/22/30

---

## 2. Initial Configuration Screen

### 5 Required Inputs

1. **Domain** (chip selection)
   - Fast Food, E-Commerce, Healthcare, Banking, Real Estate, Retail, Tourism, Education, Logistics, Telecom, Automobile, Agriculture, Other

2. **Function** (chip selection)
   - Sales & Marketing, Operations, Finance, HR, Supply Chain, Customer Service, Product, Risk & Compliance, IT, Other

3. **Difficulty** (chip selection)
   - Easy | Medium | Difficult
   - Shows auto-config preview: "5,000 rows | 5 tables | 15 columns"

4. **Data Structure** (toggle)
   - Normalized âšª | âšª Denormalized
   - Note: If Denormalized, table count hidden

5. **Context** (optional textarea, 2000 chars)
   - Placeholder: "Describe requirements, KPIs, focus areas..."

**Button**: "â–¶ï¸ Generate Challenge" (disabled until 1-4 filled)

---

## 3. Phase 1: Research & Problem Generation

### Research Integration

**6 APIs in Parallel**:

1. **NewsData.io**
   - Key: `pub_e438d98854874fd2a3f8df81bf56ab02`
   - Focus: Latest industry news

2. **NewsAPI.org**
   - Key: `bdfd54b3163f478c9e928ece3720f3c8`
   - Focus: Top headlines

3. **Google Trends**
   - Method: pytrends
   - Focus: Trending topics

4. **Medium RSS**
   - Method: feedparser
   - Feeds: `https://medium.com/feed/tag/{domain}`

5. **Tavily AI**
   - Free tier API
   - Focus: Recent insights

6. **DuckDuckGo Search**
   - Method: duckduckgo-search
   - Focus: Broad coverage

**Rate Limit Handling**: If API fails, continue with others. Minimum 2 sources required.

### Case Study Selection

From aggregated research:
1. Select ONE primary case study (most recent + relevant)
2. Use as foundation for problem statement
3. Keep other sources as supporting context

### Problem Generation (Groq)

**Input**: Primary case study + supporting sources + config  
**Output** (JSON):
```json
{
  "fictional_company_name": "ShopSphere",
  "challenge_title": "Reversing Retention Crisis",
  "problem_statement": "300-400 words with Bruce/Tony/Peter",
  "analytical_questions": ["Q1", "Q2", ...],
  "primary_kpis": ["CLV", "Repeat Rate", ...]
}
```

**Questions by Difficulty**:
- Easy: 4-5 questions
- Medium: 5-6 questions  
- Difficult: 6-7 questions

### Output Display

- Problem statement (characters highlighted: Bruce ğŸŸ£, Tony ğŸ”µ, Peter ğŸŸ¢)
- Analytical questions
- Primary KPIs
- **Research sources** (primary case study marked ğŸŒŸ)
- âœ… Approve | ğŸ”„ Regenerate (chatbot)

**Quality Gate**: Characters mentioned, ends with "Imagine yourself as Peter Pandey..."

---

## 4. Phase 2: Schema Generation

### Groq Schema Generation

**Input**: Problem + questions + config  
**Output**: OLTP normalized schema

**Table Configuration**:
- Easy: 5 tables (1 fact + 4 dims, 15 total columns)
- Medium: 8 tables (2 facts + 6 dims, 22 total columns)
- Difficult: 12 tables (2 facts + 10 dims, 30 total columns)

### Display

- ER diagram
- Table details (expandable)
- Column specifications
- Validation: All questions answerable
- âœ… Approve | ğŸ”„ Regenerate (chatbot)

**Quality Gate**: Schema supports all questions + KPIs

---

## 5. Phase 3: Dataset Preview

### Preview Generation

**Sample Rows**:
- Easy: 10 rows per table
- Medium: 20 rows per table
- Difficult: 30 rows per table

**Validation**:
- Referential integrity
- Realistic distributions
- Sample edge cases

### Display

- Data tables
- Quick stats
- Relationship validation
- Mini charts
- âœ… Approve | ğŸ”„ Regenerate (chatbot)

**Quality Gate**: Patterns look realistic

---

## 6. Phase 4: Full Dataset & Quality Validation

### Full Generation

**Sizes**: 5K / 10K / 20K rows (by difficulty)

**Process**:
1. Generate dimensions (10% of fact size)
2. Generate fact table(s)
3. Apply intentional issues (5-7%)
4. Validate

### Quality Validation

**Comprehensive QA**:
- Technical: FK integrity, nulls, types, ranges
- Business: Calculations, constraints, KPIs
- Statistical: Distributions, correlations, outliers
- Relationships: Join validation
- Learning: Question coverage

**Quality PDF**: High-quality with Codebasics logo (top-left), matplotlib charts

### Excel Solution Generation â­ NEW

**Structure**: One sheet per question

**Each Sheet Contains**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Q1: [Question text]             â”‚
â”‚                                 â”‚
â”‚ ANSWER:                         â”‚
â”‚ [Insights and findings]         â”‚
â”‚                                 â”‚
â”‚ APPROACH:                       â”‚
â”‚ [Methodology]                   â”‚
â”‚                                 â”‚
â”‚ SAMPLE QUERY:                   â”‚
â”‚ [SQL code if applicable]        â”‚
â”‚                                 â”‚
â”‚ RESULTS:                        â”‚
â”‚ [Data table]                    â”‚
â”‚                                 â”‚
â”‚ [Embedded Excel Chart] ğŸ“Š       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Chart Types**: Bar, Line, Pie, Scatter (embedded in Excel using openpyxl.chart)

**Quality Gate**: QA score â‰¥ 8/10

---

## 7. Phase 5: Final Downloads

### ZIP Structure

```
[Company]_Challenge_[Date].zip
â”‚
â”œâ”€â”€ datasets/
â”‚   â”œâ”€â”€ dim_customers.csv
â”‚   â”œâ”€â”€ dim_products.csv
â”‚   â”œâ”€â”€ fact_sales.csv
â”‚   â””â”€â”€ [all tables...]
â”‚
â”œâ”€â”€ documentation/
â”‚   â”œâ”€â”€ Challenge_Document.pdf â­ Logo top-left
â”‚   â”œâ”€â”€ Data_Dictionary.csv
â”‚   â”œâ”€â”€ README.txt
â”‚
â”œâ”€â”€ quality_assurance/
â”‚   â”œâ”€â”€ Data_Quality_Report.pdf â­ Logo top-left
â”‚   â””â”€â”€ QA_Results.json
â”‚
â”œâ”€â”€ solutions/
â”‚   â””â”€â”€ Solution_Analysis.xlsx â­ NEW
â”‚       (Sheets: Q1, Q2, ..., each with chart)
â”‚
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ Research_Sources.txt â­ Primary case study marked
â”‚   â”œâ”€â”€ Schema_Diagram.png
â”‚   â””â”€â”€ Suggested_Visualizations.txt
â”‚
â””â”€â”€ metadata.json
```

### Key Files

**Challenge_Document.pdf**:
- Codebasics logo (top-left, every page)
- Professional design
- Problem + questions + characters + KPIs
- Research attribution

**Data_Quality_Report.pdf**:
- Codebasics logo (top-left)
- 11 pages with matplotlib charts
- Professional formatting

**Solution_Analysis.xlsx** â­ NEW:
- One sheet per question
- Embedded Excel charts (not images)
- Complete answers + approach + data

**Research_Sources.txt** â­ UPDATED:
- Primary case study marked with ğŸŒŸ
- All 6 sources listed with URLs
- Relevance notes

---

## 8. Technical Implementation

### LLM: Groq Integration

**Usage**: All AI generation (problem, schema, validation)  
**Configuration**: Already provided to antigravity  
**Error Handling**: If Groq fails â†’ show error "Please contact vishal@codebasics.io"

### Research APIs

**Parallel Execution**: ThreadPoolExecutor for 6 APIs  
**Timeout**: 10 seconds per API  
**Rate Limits**: Skip failed APIs, continue with others  
**Minimum**: 2 successful sources required

### PDF Generation

**Library**: ReportLab or similar  
**Logo**: Top-left on all pages  
**Charts**: matplotlib â†’ embedded as images  
**Quality**: Professional fonts, spacing, colors

### Excel Generation

**Library**: openpyxl  
**Charts**: Use openpyxl.chart (BarChart, LineChart, PieChart)  
**Format**: One workbook, multiple sheets (Q1, Q2, ...)

---

## 9. Error Handling

### Groq API Failure

**Action**: Show error message  
**Message**: "An error occurred with our AI service. Please contact vishal@codebasics.io for assistance."  
**No Fallback**: Do not fall back to other LLMs

### Research API Failures

**Action**: Continue with working APIs  
**Minimum**: At least 2 sources must succeed  
**Error**: If < 2 sources â†’ show error, ask to retry

### Rate Limits

**Detection**: Catch RateLimitError  
**Action**: Skip that API, continue with others  
**Logging**: Log which APIs hit limits

---

## 10. Acceptance Criteria

### Must Have âœ…

**Initial Screen**:
- 5 inputs (domain, function, difficulty, structure, context)
- Auto-config display
- Validation

**Phase 1**:
- 6 API research (parallel)
- Primary case study selection
- Problem generation (Groq)
- Character highlighting
- Research sources display
- Chatbot regeneration

**Phase 2**:
- OLTP schema (Groq)
- Auto table count by difficulty
- Validation
- Chatbot regeneration

**Phase 3**:
- Preview generation
- Relationship validation
- Chatbot regeneration

**Phase 4**:
- Full dataset (5K/10K/20K)
- Quality PDF with logo + matplotlib
- **Excel solution with embedded charts** â­
- Chatbot regeneration

**Phase 5**:
- Complete ZIP
- All files high-quality
- Logo on PDFs
- Excel solution included

### Quality Standards

**All PDFs**:
- Codebasics logo (top-left)
- Professional design
- High-resolution charts

**Excel Solution**:
- One sheet per question
- Embedded charts (not images)
- Complete answers

**Research**:
- Primary case study marked
- All sources attributed

---

## 11. Phase 2 Development Checklist

**Research Integration**:
- [ ] NewsData.io integration
- [ ] NewsAPI.org integration
- [ ] Google Trends integration
- [ ] Medium RSS integration
- [ ] Tavily AI integration
- [ ] DuckDuckGo integration
- [ ] Parallel execution
- [ ] Case study selection algorithm

**Groq Integration**:
- [ ] Problem generation
- [ ] Schema generation
- [ ] Error handling

**Excel Solution**:
- [ ] Workbook creation
- [ ] Sheet per question structure
- [ ] Embedded chart generation
- [ ] Data table formatting

**PDF Enhancement**:
- [ ] Codebasics logo integration
- [ ] High-quality design template
- [ ] matplotlib chart embedding

**Auto-Configuration**:
- [ ] Difficulty-based sizing
- [ ] Table count logic
- [ ] Column distribution

**Testing**:
- [ ] End-to-end workflow
- [ ] Error scenarios
- [ ] Rate limit handling
- [ ] File downloads

---

## 12. Support & Contact

**Primary Contact**: vishal@codebasics.io

**For**:
- Groq API issues
- Technical questions
- Bug reports
- Feature requests

---

## Summary of Changes

### From Phase 1 â†’ Production

1. âœ… Removed Phase 0 as separate phase â†’ single input screen
2. âœ… Auto-configuration by difficulty (rows, tables, columns)
3. âœ… 6 research APIs (parallel aggregation)
4. âœ… Primary case study selection
5. âœ… Groq LLM integration
6. âœ… High-quality PDFs with Codebasics logo
7. âœ… Excel solution file with embedded charts
8. âœ… Updated research attribution
9. âœ… Streamlined workflow (5 phases)
10. âœ… Smart defaults, simplified UX

---

**END OF PRD**

Next: Phase 2 Development â†’ Production Launch

Contact: vishal@codebasics.io